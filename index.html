<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReadyToBoard - Formalités & Budget Voyage</title>
    
    <!-- Chargement des librairies nécessaires (React, Tailwind, Babel) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Police d'écriture moderne -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;800&display=swap');
        body { font-family: 'Outfit', sans-serif; background-color: #f8fafc; }
        
        /* Animations personnalisées */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-in { animation: fadeIn 0.6s ease-out forwards; }
        
        /* Masquer la scrollbar sur mobile pour le menu horizontal si besoin */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICÔNES (Intégrées directement pour éviter les erreurs d'import sur GitHub) ---
        const Icon = ({ children, size = 24, className = "", strokeWidth = 2, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>
                {children}
            </svg>
        );

        const Plane = (props) => <Icon {...props}><path d="M2 12h20"/><path d="M13 2l9 10-9 10"/><path d="M2 12l5-5m-5 5l5 5"/></Icon>;
        const MapPin = (props) => <Icon {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></Icon>;
        const Calendar = (props) => <Icon {...props}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></Icon>;
        const ShieldCheck = (props) => <Icon {...props}><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/><path d="m9 12 2 2 4-4"/></Icon>;
        const Trophy = (props) => <Icon {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 1 0 5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></Icon>;
        const ArrowRight = (props) => <Icon {...props}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></Icon>;
        const Heart = (props) => <Icon {...props}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></Icon>;
        const Globe = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><line x1="2" x2="22" y1="12" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></Icon>;
        const ExternalLink = (props) => <Icon {...props}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></Icon>;
        const CheckCircle = (props) => <Icon {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></Icon>;
        const AlertTriangle = (props) => <Icon {...props}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></Icon>;
        const Info = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></Icon>;
        const Languages = (props) => <Icon {...props}><path d="m5 8 6 6"/><path d="m4 14 6-6 2-3"/><path d="M2 5h12"/><path d="M7 2h1"/><path d="m22 22-5-10-5 10"/><path d="M14 18h6"/></Icon>;
        const Clock = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></Icon>;
        const Copyright = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><path d="M14.83 14.83a4 4 0 1 1 0-5.66"/></Icon>;
        const Navigation = (props) => <Icon {...props}><polygon points="3 11 22 2 13 21 11 13 3 11"/></Icon>;
        const LinkIcon = (props) => <Icon {...props}><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></Icon>;
        const Stethoscope = (props) => <Icon {...props}><path d="M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3"/><path d="M8 15v6"/><path d="M16 15v6a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-6"/><circle cx="12" cy="9" r="1"/></Icon>;
        const Droplets = (props) => <Icon {...props}><path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"/><path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97"/></Icon>;
        const Siren = (props) => <Icon {...props}><path d="M7 12a5 5 0 0 1 5-5v0a5 5 0 0 1 5 5v6H7v-6Z"/><path d="M5 20a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v2H5v-2Z"/><path d="M21 12h1"/><path d="M18.5 4.5 18 5"/><path d="M2 12h1"/><path d="M5.5 4.5 6 5"/></Icon>;
        const Wifi = (props) => <Icon {...props}><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><line x1="12" x2="12.01" y1="20" y2="20"/></Icon>;
        const Ticket = (props) => <Icon {...props}><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M13 5v2"/><path d="M13 17v2"/><path d="M13 11v2"/></Icon>;
        const Timer = (props) => <Icon {...props}><line x1="10" x2="14" y1="2" y2="2"/><line x1="12" x2="15" y1="14" y2="11"/><circle cx="12" cy="14" r="8"/></Icon>;
        const MessageSquare = (props) => <Icon {...props}><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></Icon>;
        const Wallet = (props) => <Icon {...props}><path d="M20 12V8H6a2 2 0 0 1-2-2c0-1.1.9-2 2-2h12v4"/><path d="M4 6v12c0 1.1.9 2 2 2h14v-4"/><path d="M18 12a2 2 0 0 0-2 2c0 1.1.9 2 2 2h4v-4h-4z"/></Icon>;
        const Umbrella = (props) => <Icon {...props}><path d="M22 12a10.06 10.06 1 0 0-20 0Z"/><path d="M12 12v8a2 2 0 0 0 4 0"/><path d="M12 2v1"/></Icon>;
        const HelpCircle = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></Icon>;
        const Home = (props) => <Icon {...props}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></Icon>;
        const Utensils = (props) => <Icon {...props}><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></Icon>;
        const Bus = (props) => <Icon {...props}><path d="M8 6v6"/><path d="M15 6v6"/><path d="M2 12h19.6"/><path d="M18 18h3s.5-1.7.8-2.8c.1-.4.2-.8.2-1.2 0-.4-.1-.8-.2-1.2l-1.4-5C20.1 6.8 19.1 6 18 6H4a2 2 0 0 0-2 2v10h3"/><circle cx="7" cy="18" r="2"/><path d="M9 18h5"/><circle cx="16" cy="18" r="2"/></Icon>;
        const Bed = (props) => <Icon {...props}><path d="M2 4v16"/><path d="M2 8h18a2 2 0 0 1 2 2v10"/><path d="M2 17h20"/><path d="M6 8v9"/></Icon>;

        // --- CONFIGURATION AFFILIATION ---
        const AFFILIATE_CONFIG = {
          flight_marker: "YOUR_ID", 
          hotel_aid: "YOUR_ID",
          esim_id: "YOUR_ID", 
          activities_id: "YOUR_ID"
        };

        // --- TRADUCTIONS ---
        const translations = {
          FR: {
            subtitle: "V1.0 Mondiale",
            nav_home: "Formalités",
            nav_budget: "Budget",
            nav_insurance: "Assurance",
            nav_help: "Aide",
            label_nationality: "Votre Nationalité (Passeport)",
            label_origin: "Pays de départ (Pour le vol)",
            label_destination: "Destination",
            label_age: "Âge du voyageur",
            label_start_date: "Date de départ",
            label_end_date: "Date de retour",
            placeholder_select: "Sélectionner un pays...",
            btn_analyze: "Lancer l'analyse",
            loading_title: "Analyse de votre itinéraire",
            loading_text: "Vérification des formalités...",
            result_back: "Modifier",
            passport_power: "Puissance du Passeport",
            access_text: "Accès simplifié à",
            countries_text: "pays",
            docs_title: "Documents & Liens Officiels",
            health_title: "Santé & Hygiène",
            customs_title: "Douanes & Interdits (Attention !)",
            docs_disclaimer: "Les liens redirigent vers les sites gouvernementaux officiels.",
            action_title: "Réserver au meilleur prix",
            action_flight: "Vols : Accéder aux tarifs secrets (-30%)",
            action_hotel: "Hôtels : Voir les offres exclusives (-40%)",
            offer_expires: "Ces offres tarifaires expirent dans",
            services_title: "Indispensables pour ce voyage",
            service_esim: "Internet sur place (eSIM)",
            service_esim_desc: "Restez connecté sans frais d'itinérance.",
            service_activities: "Activités & Visites",
            service_activities_desc: "Billets coupe-file et excursions.",
            donate_title: "Soutenez ce projet gratuit",
            donate_text: "TravelDoc est 100% gratuit. Si nous vous avons aidé, offrez-nous un café !",
            donate_btn: "Faire un don",
            hero_title: "Préparez votre départ",
            hero_highlight: "simplement",
            hero_desc: "Visas, vaccins, interdits douaniers... on vous dit tout.",
            doc_mandatory: "Obligatoire",
            cost: "Coût",
            footer_rights: "Tous droits réservés. Reproduction interdite.",
            footer_affiliate: "Transparence : Ce site contient des liens affiliés.",
            duration_calc: "Durée du séjour :",
            origin_same_dest_error: "Le pays de départ et la destination ne peuvent pas être identiques.",
            missing_dest_error: "Veuillez sélectionner une destination.",
            btn_official_link: "Accéder au site officiel",
            water_safe: "Eau du robinet potable",
            water_unsafe: "Eau du robinet NON potable",
            vaccine_mandatory: "Vaccin Obligatoire :",
            forbidden_items: "Strictement Interdit :",
            budget_title: "Calculateur de Budget Voyage",
            budget_desc: "Estimez vos dépenses quotidiennes selon votre style de voyage.",
            style_backpacker: "Économique (Backpacker)",
            style_standard: "Standard (Confort)",
            style_luxury: "Premium / Luxe",
            budget_total: "Budget Total Estimé",
            budget_per_day: "par jour",
            budget_breakdown: "Répartition journalière moyenne :",
            cat_accom: "Hébergement",
            cat_food: "Nourriture",
            cat_transport: "Transport & Activités",
            ins_title: "Assurance Voyage : Est-ce nécessaire ?",
            ins_desc: "Comparatif neutre pour comprendre vos besoins.",
            ins_card_bank: "Carte Bancaire (Visa/Mastercard)",
            ins_card_bank_desc: "Couvre souvent l'essentiel pour les séjours < 90 jours, mais avec des franchises élevées et des plafonds bas.",
            ins_card_spec: "Assurance Spécialisée",
            ins_card_spec_desc: "Indispensable pour les pays à frais médicaux élevés (USA, Canada, Asie) ou les longs séjours. Plafonds illimités.",
            ins_btn_compare: "Comparer les offres",
            help_title: "Aidez-nous à améliorer TravelDoc",
            help_desc: "Une erreur sur un visa ? Un pays manquant ? Dites-le nous !",
            label_name: "Votre Nom",
            label_email: "Votre Email",
            label_message: "Votre Message",
            btn_send: "Envoyer le message",
            feedback_success: "Merci ! Votre message a bien été envoyé."
          },
          EN: {
            subtitle: "V1.0 Global",
            nav_home: "Formalities",
            nav_budget: "Budget",
            nav_insurance: "Insurance",
            nav_help: "Help",
            label_nationality: "Your Nationality (Passport)",
            label_origin: "Departure Country",
            label_destination: "Destination",
            label_age: "Traveler Age",
            label_start_date: "Departure Date",
            label_end_date: "Return Date",
            placeholder_select: "Select a country...",
            btn_analyze: "Start Analysis",
            loading_title: "Analyzing Itinerary",
            loading_text: "Checking formalities...",
            result_back: "Edit",
            passport_power: "Passport Power",
            access_text: "Easy access to",
            countries_text: "countries",
            docs_title: "Documents & Official Links",
            health_title: "Health & Hygiene",
            customs_title: "Customs & Forbidden Items",
            docs_disclaimer: "Links redirect to official government websites.",
            action_title: "Book at the best price",
            action_flight: "Flights: Unlock secret fares (-30%)",
            action_hotel: "Hotels: See exclusive deals (-40%)",
            offer_expires: "These offers expire in",
            services_title: "Essentials for this trip",
            service_esim: "Mobile Data (eSIM)",
            service_esim_desc: "Stay connected without roaming fees.",
            service_activities: "Tours & Activities",
            service_activities_desc: "Skip-the-line tickets & tours.",
            donate_title: "Support this free project",
            donate_text: "TravelDoc is 100% free. If we helped you, buy us a coffee!",
            donate_btn: "Donate",
            hero_title: "Prepare your trip",
            hero_highlight: "simply",
            hero_desc: "Visas, vaccines, customs bans... we tell you everything.",
            doc_mandatory: "Mandatory",
            cost: "Cost",
            footer_rights: "All rights reserved. Reproduction prohibited.",
            footer_affiliate: "Transparency: This site contains affiliate links.",
            duration_calc: "Trip duration:",
            origin_same_dest_error: "Origin and destination cannot be the same.",
            missing_dest_error: "Please select a destination.",
            btn_official_link: "Access official site",
            water_safe: "Tap water is drinkable",
            water_unsafe: "Tap water is NOT drinkable",
            vaccine_mandatory: "Mandatory Vaccine:",
            forbidden_items: "Strictly Forbidden:",
            budget_title: "Travel Budget Calculator",
            budget_desc: "Estimate daily expenses based on your travel style.",
            style_backpacker: "Budget (Backpacker)",
            style_standard: "Standard (Comfort)",
            style_luxury: "Premium / Luxury",
            budget_total: "Total Estimated Budget",
            budget_per_day: "per day",
            budget_breakdown: "Average daily breakdown:",
            cat_accom: "Accommodation",
            cat_food: "Food",
            cat_transport: "Transport & Activities",
            ins_title: "Travel Insurance: Is it necessary?",
            ins_desc: "Neutral comparison to understand your needs.",
            ins_card_bank: "Credit Card Insurance",
            ins_card_bank_desc: "Often covers basics for < 90 days, but with high deductibles and low caps.",
            ins_card_spec: "Specialized Insurance",
            ins_card_spec_desc: "Essential for high medical cost countries (USA, Asia) or long trips. High caps.",
            ins_btn_compare: "Compare offers",
            help_title: "Help us improve TravelDoc",
            help_desc: "Found a visa error? Missing country? Let us know!",
            label_name: "Your Name",
            label_email: "Your Email",
            label_message: "Your Message",
            btn_send: "Send Message",
            feedback_success: "Thanks! Message sent successfully."
          },
           ES: {
            subtitle: "V1.0 Global",
            nav_home: "Formalidades",
            nav_budget: "Presupuesto",
            nav_insurance: "Seguro",
            nav_help: "Ayuda",
            label_nationality: "Su Nacionalidad (Pasaporte)",
            label_origin: "País de salida (Para vuelos)",
            label_destination: "Destino",
            label_age: "Edad del viajero",
            label_start_date: "Fecha de salida",
            label_end_date: "Fecha de regreso",
            placeholder_select: "Seleccionar país...",
            btn_analyze: "Iniciar Análisis",
            loading_title: "Analizando Itinerario",
            loading_text: "Verificando trámites...",
            result_back: "Editar",
            passport_power: "Poder del Pasaporte",
            access_text: "Acceso fácil a",
            countries_text: "países",
            docs_title: "Documentos y Enlaces Oficiales",
            health_title: "Salud e Higiene",
            customs_title: "Aduanas y Prohibiciones",
            docs_disclaimer: "Los enlaces redirigen a sitios web oficiales del gobierno.",
            action_title: "Reservar al mejor precio",
            action_flight: "Vuelos: Acceder a tarifas secretas (-30%)",
            action_hotel: "Hoteles: Ver ofertas exclusivas (-40%)",
            offer_expires: "Estas ofertas expiran en",
            services_title: "Imprescindibles para este viaje",
            service_esim: "Internet (eSIM)",
            service_esim_desc: "Conectividad sin roaming.",
            service_activities: "Actividades y Tours",
            service_activities_desc: "Entradas sin colas y excursiones.",
            donate_title: "Apoye este proyecto",
            donate_text: "TravelDoc es 100% gratuito. ¡Invítanos a un café!",
            donate_btn: "Donar",
            hero_title: "Prepare su viaje",
            hero_highlight: "simplemente",
            hero_desc: "Visas, vacunas, prohibiciones... le contamos todo.",
            doc_mandatory: "Obligatorio",
            cost: "Costo",
            footer_rights: "Todos los derechos reservados. Prohibida la reproducción.",
            footer_affiliate: "Este sitio contiene enlaces de afiliados.",
            duration_calc: "Duración del viaje:",
            origin_same_dest_error: "El origen y el destino no pueden ser iguales.",
            missing_dest_error: "Por favor seleccione un destino.",
            btn_official_link: "Acceder al sitio oficial",
            water_safe: "Agua del grifo potable",
            water_unsafe: "Agua del grifo NO potable",
            vaccine_mandatory: "Vacuna Obligatoria:",
            forbidden_items: "Estrictamente Prohibido:",
            budget_title: "Calculadora de Presupuesto",
            budget_desc: "Estime sus gastos diarios según su estilo de viaje.",
            style_backpacker: "Económico (Mochilero)",
            style_standard: "Estándar (Confort)",
            style_luxury: "Premium / Lujo",
            budget_total: "Presupuesto Total Estimado",
            budget_per_day: "por día",
            budget_breakdown: "Desglose diario promedio:",
            cat_accom: "Alojamiento",
            cat_food: "Comida",
            cat_transport: "Transporte y Actividades",
            ins_title: "Seguro de Viaje: ¿Es necesario?",
            ins_desc: "Comparación neutral para entender sus necesidades.",
            ins_card_bank: "Seguro de Tarjeta de Crédito",
            ins_card_bank_desc: "A menudo cubre lo básico para < 90 días, pero con franquicias altas y topes bajos.",
            ins_card_spec: "Seguro Especializado",
            ins_card_spec_desc: "Esencial para países con altos costos médicos (EE. UU., Asia) o viajes largos.",
            ins_btn_compare: "Comparar ofertas",
            help_title: "Ayúdenos a mejorar TravelDoc",
            help_desc: "¿Encontró un error en una visa? ¿Falta un país? ¡Díganoslo!",
            label_name: "Su Nombre",
            label_email: "Su Email",
            label_message: "Su Mensaje",
            btn_send: "Enviar Mensaje",
            feedback_success: "¡Gracias! Su mensaje ha sido enviado."
          },
          ZH: {
            subtitle: "V1.0 全球",
            nav_home: "手续",
            nav_budget: "预算",
            nav_insurance: "保险",
            nav_help: "帮助",
            label_nationality: "您的国籍 (护照)",
            label_origin: "出发国家 (航班)",
            label_destination: "目的地",
            label_age: "旅客年龄",
            label_start_date: "出发日期",
            label_end_date: "返回日期",
            placeholder_select: "选择国家...",
            btn_analyze: "开始分析",
            loading_title: "正在分析行程",
            loading_text: "正在检查手续...",
            result_back: "修改",
            passport_power: "护照效力",
            access_text: "免签/落地签国家",
            countries_text: "个",
            docs_title: "所需文件及官方链接",
            health_title: "健康与卫生",
            customs_title: "海关与禁令",
            docs_disclaimer: "链接将重定向至政府官方网站。",
            action_title: "以最优惠价格预订",
            action_flight: "航班：解锁秘密票价 (-30%)",
            action_hotel: "酒店：查看独家优惠 (-40%)",
            offer_expires: "优惠截止时间",
            services_title: "旅行必备",
            service_esim: "移动数据 (eSIM)",
            service_esim_desc: "保持连接，无漫游费。",
            service_activities: "活动与游览",
            service_activities_desc: "免排队门票和游览。",
            donate_title: "支持这个免费项目",
            donate_text: "TravelDoc 100% 免费。如果对您有帮助，请请我们喝杯咖啡！",
            donate_btn: "捐赠",
            hero_title: "轻松准备",
            hero_highlight: "您的行程",
            hero_desc: "签证、疫苗、海关禁令...我们告诉您一切。",
            doc_mandatory: "必须",
            cost: "费用",
            footer_rights: "版权所有。禁止转载。",
            footer_affiliate: "本网站包含附属链接。",
            duration_calc: "旅行时长：",
            origin_same_dest_error: "出发地和目的地不能相同。",
            missing_dest_error: "请选择目的地。",
            btn_official_link: "访问官方网站",
            water_safe: "自来水可饮用",
            water_unsafe: "自来水不可饮用",
            vaccine_mandatory: "强制疫苗：",
            forbidden_items: "严格禁止：",
            budget_title: "旅行预算计算器",
            budget_desc: "根据您的旅行风格估算每日开销。",
            style_backpacker: "经济型 (背包客)",
            style_standard: "标准型 (舒适)",
            style_luxury: "高级/豪华",
            budget_total: "总预算估算",
            budget_per_day: "每天",
            budget_breakdown: "平均每日细分：",
            cat_accom: "住宿",
            cat_food: "餐饮",
            cat_transport: "交通与活动",
            ins_title: "旅行保险：有必要吗？",
            ins_desc: "中立比较以了解您的需求。",
            ins_card_bank: "信用卡保险",
            ins_card_bank_desc: "通常涵盖90天内的基本费用，但免赔额高，上限低。",
            ins_card_spec: "专业保险",
            ins_card_spec_desc: "对于医疗费用高的国家（美国、亚洲）或长途旅行至关重要。上限无限。",
            ins_btn_compare: "比较优惠",
            help_title: "帮助我们改进 TravelDoc",
            help_desc: "发现签证错误？缺少国家？请告诉我们！",
            label_name: "您的姓名",
            label_email: "您的邮箱",
            label_message: "您的留言",
            btn_send: "发送留言",
            feedback_success: "谢谢！您的留言已发送。"
          },
           JA: {
            subtitle: "V1.0 グローバル",
            nav_home: "手続き",
            nav_budget: "予算",
            nav_insurance: "保険",
            nav_help: "ヘルプ",
            label_nationality: "あなたの国籍 (パスポート)",
            label_origin: "出発国 (フライト用)",
            label_destination: "目的地",
            label_age: "旅行者の年齢",
            label_start_date: "出発日",
            label_end_date: "帰国日",
            placeholder_select: "国を選択...",
            btn_analyze: "分析開始",
            loading_title: "旅程を分析中",
            loading_text: "手続きを確認中...",
            result_back: "編集",
            passport_power: "パスポートランク",
            access_text: "アクセス可能",
            countries_text: "カ国",
            docs_title: "必要書類と公式リンク",
            health_title: "健康・衛生",
            customs_title: "税関・禁止品目",
            docs_disclaimer: "リンクは政府公式サイトにリダイレクトされます。",
            action_title: "最安値で予約する",
            action_flight: "フライト：シークレット運賃 (-30%)",
            action_hotel: "ホテル：限定割引を見る (-40%)",
            offer_expires: "オファー終了まで",
            services_title: "旅行の必需品",
            service_esim: "データ通信 (eSIM)",
            service_esim_desc: "ローミング料なしで接続。",
            service_activities: "アクティビティ＆ツアー",
            service_activities_desc: "優先入場チケットなど。",
            donate_title: "プロジェクトを支援",
            donate_text: "TravelDocは完全無料です。役に立ったらコーヒーを一杯！",
            donate_btn: "寄付する",
            hero_title: "旅行の準備を",
            hero_highlight: "シンプルに",
            hero_desc: "ビザ、ワクチン、持ち込み禁止品...すべてお教えします。",
            doc_mandatory: "必須",
            cost: "費用",
            footer_rights: "全著作権所有。無断転載を禁じます。",
            footer_affiliate: "当サイトにはアフィリエイトリンクが含まれます。",
            duration_calc: "旅行期間：",
            origin_same_dest_error: "出発地と目的地は同じにできません。",
            missing_dest_error: "目的地を選択してください。",
            btn_official_link: "公式サイトへ",
            water_safe: "水道水は飲用可",
            water_unsafe: "水道水は飲用不可",
            vaccine_mandatory: "必須ワクチン：",
            forbidden_items: "厳禁：",
            budget_title: "旅行予算計算機",
            budget_desc: "旅行スタイルに基づいて毎日の費用を見積もります。",
            style_backpacker: "エコノミー (バックパッカー)",
            style_standard: "スタンダード (快適)",
            style_luxury: "プレミアム / ラグジュアリー",
            budget_total: "推定総予算",
            budget_per_day: "1日あたり",
            budget_breakdown: "1日あたりの平均内訳：",
            cat_accom: "宿泊費",
            cat_food: "食費",
            cat_transport: "交通費＆アクティビティ",
            ins_title: "旅行保険：必要ですか？",
            ins_desc: "ニーズを理解するための中立的な比較。",
            ins_card_bank: "クレジットカード付帯保険",
            ins_card_bank_desc: "90日未満の基本事項をカバーすることが多いですが、免責金額が高く、上限が低いです。",
            ins_card_spec: "専門保険",
            ins_card_spec_desc: "医療費の高い国（アメリカ、アジア）や長期滞在には必須です。上限無制限。",
            ins_btn_compare: "オファーを比較",
            help_title: "TravelDocの改善にご協力ください",
            help_desc: "ビザの間違いを見つけましたか？国が足りませんか？教えてください！",
            label_name: "お名前",
            label_email: "メールアドレス",
            label_message: "メッセージ",
            btn_send: "メッセージを送信",
            feedback_success: "ありがとうございます！メッセージが送信されました。"
          },
           KO: {
            subtitle: "V1.0 글로벌",
            nav_home: "수속",
            nav_budget: "예산",
            nav_insurance: "보험",
            nav_help: "도움말",
            label_nationality: "국적 (여권)",
            label_origin: "출발 국가 (항공편)",
            label_destination: "목적지",
            label_age: "여행자 나이",
            label_start_date: "출발 날짜",
            label_end_date: "도착 날짜",
            placeholder_select: "국가 선택...",
            btn_analyze: "분석 시작",
            loading_title: "일정 분석 중",
            loading_text: "수속 확인 중...",
            result_back: "수정",
            passport_power: "여권 파워",
            access_text: "무비자 입국 가능",
            countries_text: "개국",
            docs_title: "필요 서류 및 공식 링크",
            health_title: "건강 및 위생",
            customs_title: "세관 및 금지 품목",
            docs_disclaimer: "링크는 공식 정부 웹사이트로 연결됩니다.",
            action_title: "최저가 예약하기",
            action_flight: "항공권: 시크릿 특가 보기 (-30%)",
            action_hotel: "호텔: 특가 보기 (-40%)",
            offer_expires: "특가 종료까지",
            services_title: "여행 필수품",
            service_esim: "데이터 유심 (eSIM)",
            service_esim_desc: "로밍 요금 없이 인터넷 사용.",
            service_activities: "액티비티 & 투어",
            service_activities_desc: "패스트트랙 티켓 및 투어.",
            donate_title: "무료 프로젝트 후원",
            donate_text: "TravelDoc은 100% 무료입니다. 도움이 되셨다면 커피 한 잔 후원해주세요!",
            donate_btn: "후원하기",
            hero_title: "여행 준비를",
            hero_highlight: "간편하게",
            hero_desc: "비자, 백신, 반입 금지 품목... 모든 것을 알려드립니다.",
            doc_mandatory: "필수",
            cost: "비용",
            footer_rights: "모든 권리 보유. 무단 전재 금지.",
            footer_affiliate: "이 사이트에는 제휴 링크가 포함되어 있습니다.",
            duration_calc: "여행 기간:",
            origin_same_dest_error: "출발지와 목적지는 같을 수 없습니다.",
            missing_dest_error: "목적지를 선택해주세요.",
            btn_official_link: "공식 사이트 접속",
            water_safe: "수돗물 식수 가능",
            water_unsafe: "수돗물 식수 불가",
            vaccine_mandatory: "필수 백신:",
            forbidden_items: "엄격히 금지됨:",
            budget_title: "여행 예산 계산기",
            budget_desc: "여행 스타일에 따라 일일 비용을 추정하세요.",
            style_backpacker: "알뜰형 (배낭여행)",
            style_standard: "표준형 (편안함)",
            style_luxury: "프리미엄 / 럭셔리",
            budget_total: "총 예상 예산",
            budget_per_day: "일일",
            budget_breakdown: "일일 평균 내역:",
            cat_accom: "숙박",
            cat_food: "식사",
            cat_transport: "교통 및 액티비티",
            ins_title: "여행자 보험: 필요할까요?",
            ins_desc: "필요를 이해하기 위한 중립적인 비교.",
            ins_card_bank: "신용카드 보험",
            ins_card_bank_desc: "90일 미만 여행의 기본 사항을 보장하지만, 자기부담금이 높고 한도가 낮습니다.",
            ins_card_spec: "전문 보험",
            ins_card_spec_desc: "의료비가 높은 국가(미국, 아시아)나 장기 여행에 필수적입니다. 한도 무제한.",
            ins_btn_compare: "상품 비교",
            help_title: "TravelDoc 개선 돕기",
            help_desc: "비자 오류를 발견하셨나요? 국가가 누락되었나요? 알려주세요!",
            label_name: "이름",
            label_email: "이메일",
            label_message: "메시지",
            btn_send: "메시지 보내기",
            feedback_success: "감사합니다! 메시지가 전송되었습니다."
          }
        };

// --- BASE DE DONNÉES COMPLÈTE (AVEC BUDGETS €/jour) ---
const countries = [
  // EUROPE
  { code: "FR", name: "France", region: "EU", continent: "Europe", power: 128, water: "safe", budget: { low: 60, mid: 140, high: 300 } },
  { code: "ES", name: "Espagne", region: "EU", continent: "Europe", power: 129, water: "safe", budget: { low: 50, mid: 120, high: 250 } },
  { code: "IT", name: "Italie", region: "EU", continent: "Europe", power: 129, water: "safe", budget: { low: 60, mid: 135, high: 280 } },
  { code: "PT", name: "Portugal", region: "EU", continent: "Europe", power: 128, water: "safe", budget: { low: 45, mid: 110, high: 220 } },
  { code: "GR", name: "Grèce", region: "EU", continent: "Europe", power: 125, water: "safe", budget: { low: 50, mid: 130, high: 260 } },
  { code: "GB", name: "Royaume-Uni", region: "EU_NON_SCHENGEN", continent: "Europe", power: 125, water: "safe", budget: { low: 70, mid: 160, high: 350 } },
  { code: "DE", name: "Allemagne", region: "EU", continent: "Europe", power: 129, water: "safe", budget: { low: 65, mid: 140, high: 280 } },
  { code: "CH", name: "Suisse", region: "EU", continent: "Europe", power: 126, water: "safe", budget: { low: 90, mid: 200, high: 450 } },
  { code: "NL", name: "Pays-Bas", region: "EU", continent: "Europe", power: 127, water: "safe", budget: { low: 70, mid: 150, high: 300 } },
  { code: "BE", name: "Belgique", region: "EU", continent: "Europe", power: 127, water: "safe", budget: { low: 65, mid: 140, high: 280 } },
  { code: "IE", name: "Irlande", region: "EU_NON_SCHENGEN", continent: "Europe", power: 126, water: "safe", budget: { low: 70, mid: 160, high: 320 } },
  { code: "IS", name: "Islande", region: "EU_NON_SCHENGEN", continent: "Europe", power: 120, water: "safe", budget: { low: 90, mid: 220, high: 500 } },
  { code: "NO", name: "Norvège", region: "EU", continent: "Europe", power: 126, water: "safe", budget: { low: 80, mid: 190, high: 400 } },
  { code: "SE", name: "Suède", region: "EU", continent: "Europe", power: 128, water: "safe", budget: { low: 75, mid: 170, high: 350 } },
  { code: "DK", name: "Danemark", region: "EU", continent: "Europe", power: 128, water: "safe", budget: { low: 80, mid: 180, high: 380 } },
  { code: "FI", name: "Finlande", region: "EU", continent: "Europe", power: 128, water: "safe", budget: { low: 75, mid: 170, high: 350 } },
  { code: "PL", name: "Pologne", region: "EU", continent: "Europe", power: 124, water: "safe", budget: { low: 35, mid: 80, high: 180 } },
  { code: "CZ", name: "République Tchèque", region: "EU", continent: "Europe", power: 124, water: "safe", budget: { low: 40, mid: 90, high: 200 } },
  { code: "HU", name: "Hongrie", region: "EU", continent: "Europe", power: 122, water: "safe", budget: { low: 35, mid: 80, high: 180 } },
  { code: "HR", name: "Croatie", region: "EU", continent: "Europe", power: 123, water: "safe", budget: { low: 50, mid: 110, high: 240 } },
  { code: "RO", name: "Roumanie", region: "EU", continent: "Europe", power: 121, water: "safe", budget: { low: 30, mid: 70, high: 160 } },
  { code: "BG", name: "Bulgarie", region: "EU", continent: "Europe", power: 120, water: "safe", budget: { low: 30, mid: 70, high: 150 } },
  { code: "AL", name: "Albanie", region: "EU_EAST", continent: "Europe", power: 95, water: "unsafe", budget: { low: 30, mid: 60, high: 140 } },
  { code: "RU", name: "Russie", region: "EU_EAST", continent: "Europe", power: 90, water: "unsafe", budget: { low: 40, mid: 90, high: 200 }, customs: ["Médicaments codéinés", "Drones (Réglementé)"] },
  { code: "TR", name: "Turquie", region: "EU_EAST", continent: "Europe", power: 85, water: "unsafe", budget: { low: 35, mid: 80, high: 180 }, customs: ["Antiquités"] },
  { code: "UA", name: "Ukraine", region: "EU_EAST", continent: "Europe", power: 95, water: "unsafe", budget: { low: 30, mid: 70, high: 160 } },
  { code: "MT", name: "Malte", region: "EU", continent: "Europe", power: 122, water: "safe", budget: { low: 60, mid: 130, high: 260 } },
  { code: "CY", name: "Chypre", region: "EU", continent: "Europe", power: 123, water: "safe", budget: { low: 55, mid: 120, high: 250 } },
  { code: "LU", name: "Luxembourg", region: "EU", continent: "Europe", power: 127, water: "safe", budget: { low: 80, mid: 180, high: 350 } },
  { code: "MC", name: "Monaco", region: "EU_NON_SCHENGEN", continent: "Europe", power: 110, water: "safe", budget: { low: 120, mid: 300, high: 800 } },
  { code: "AD", name: "Andorre", region: "EU_NON_SCHENGEN", continent: "Europe", power: 110, water: "safe", budget: { low: 50, mid: 110, high: 220 } },
  { code: "SI", name: "Slovénie", region: "EU", continent: "Europe", power: 125, water: "safe", budget: { low: 45, mid: 100, high: 220 } },
  { code: "SK", name: "Slovaquie", region: "EU", continent: "Europe", power: 124, water: "safe", budget: { low: 40, mid: 90, high: 200 } },
  { code: "EE", name: "Estonie", region: "EU", continent: "Europe", power: 126, water: "safe", budget: { low: 45, mid: 100, high: 220 } },
  { code: "LV", name: "Lettonie", region: "EU", continent: "Europe", power: 125, water: "safe", budget: { low: 40, mid: 90, high: 200 } },
  { code: "LT", name: "Lituanie", region: "EU", continent: "Europe", power: 125, water: "safe", budget: { low: 40, mid: 90, high: 200 } },
  { code: "ME", name: "Monténégro", region: "EU_EAST", continent: "Europe", power: 100, water: "unsafe", budget: { low: 35, mid: 75, high: 180 } },
  { code: "RS", name: "Serbie", region: "EU_EAST", continent: "Europe", power: 105, water: "unsafe", budget: { low: 35, mid: 75, high: 180 } },
  { code: "BA_BOS", name: "Bosnie-Herzégovine", region: "EU_EAST", continent: "Europe", power: 95, water: "unsafe", budget: { low: 30, mid: 70, high: 160 } },
  { code: "BY", name: "Biélorussie", region: "EU_EAST", continent: "Europe", power: 80, water: "unsafe", budget: { low: 30, mid: 70, high: 160 } },

  // AMÉRIQUES
  { code: "US", name: "États-Unis", region: "NA", continent: "Amériques", power: 116, water: "safe", budget: { low: 90, mid: 250, high: 600 }, customs: ["Kinder Surprise", "Fruits/Viandes"] },
  { code: "CA", name: "Canada", region: "NA", continent: "Amériques", power: 115, water: "safe", budget: { low: 80, mid: 200, high: 450 }, customs: ["Cannabis"] },
  { code: "MX", name: "Mexique", region: "NA", continent: "Amériques", power: 90, water: "unsafe", budget: { low: 40, mid: 100, high: 250 } },
  { code: "CQ", name: "Cancún (Mexique)", region: "NA", continent: "Amériques", power: 90, water: "unsafe", budget: { low: 60, mid: 150, high: 350 }, customs: ["Cigarettes électroniques"] },
  { code: "BR", name: "Brésil", region: "SA", continent: "Amériques", power: 100, water: "unsafe", budget: { low: 45, mid: 110, high: 250 }, health: { yellowFever: true }, customs: ["Espèces protégées"] },
  { code: "AR", name: "Argentine", region: "SA", continent: "Amériques", power: 98, water: "unsafe", budget: { low: 40, mid: 90, high: 200 } },
  { code: "CO", name: "Colombie", region: "SA", continent: "Amériques", power: 80, water: "unsafe", budget: { low: 35, mid: 80, high: 180 }, health: { yellowFever: true } },
  { code: "PE", name: "Pérou", region: "SA", continent: "Amériques", power: 85, water: "unsafe", budget: { low: 35, mid: 90, high: 200 }, customs: ["Feuilles de Coca"] },
  { code: "CL", name: "Chili", region: "SA", continent: "Amériques", power: 118, water: "safe", budget: { low: 50, mid: 120, high: 280 } },
  { code: "CR", name: "Costa Rica", region: "SA", continent: "Amériques", power: 95, water: "safe", budget: { low: 50, mid: 120, high: 280 } },
  { code: "PA", name: "Panama", region: "SA", continent: "Amériques", power: 94, water: "safe", budget: { low: 50, mid: 110, high: 250 } },
  { code: "UY", name: "Uruguay", region: "SA", continent: "Amériques", power: 96, water: "safe", budget: { low: 55, mid: 130, high: 280 } },
  { code: "PY", name: "Paraguay", region: "SA", continent: "Amériques", power: 85, water: "unsafe", budget: { low: 35, mid: 80, high: 180 } },
  { code: "BO", name: "Bolivie", region: "SA", continent: "Amériques", power: 82, water: "unsafe", budget: { low: 30, mid: 70, high: 160 }, health: { yellowFever: true } },
  { code: "EC", name: "Équateur", region: "SA", continent: "Amériques", power: 86, water: "unsafe", budget: { low: 35, mid: 85, high: 190 }, health: { yellowFever: true } },
  { code: "VE", name: "Venezuela", region: "SA", continent: "Amériques", power: 70, water: "unsafe", budget: { low: 30, mid: 70, high: 150 }, health: { yellowFever: true } },
  { code: "GT", name: "Guatemala", region: "SA", continent: "Amériques", power: 88, water: "unsafe", budget: { low: 35, mid: 80, high: 180 } },
  { code: "DO", name: "République Dominicaine", region: "NA", continent: "Amériques", power: 65, water: "unsafe", budget: { low: 50, mid: 130, high: 300 } },
  { code: "CU", name: "Cuba", region: "NA", continent: "Amériques", power: 55, water: "unsafe", budget: { low: 40, mid: 90, high: 200 }, customs: ["Drones", "GPS"] },
  { code: "JM", name: "Jamaïque", region: "NA", continent: "Amériques", power: 75, water: "unsafe", budget: { low: 55, mid: 130, high: 300 } },
  { code: "BS", name: "Bahamas", region: "NA", continent: "Amériques", power: 85, water: "unsafe", budget: { low: 90, mid: 220, high: 500 } },
  { code: "BB", name: "Barbade", region: "NA", continent: "Amériques", power: 90, water: "safe", budget: { low: 80, mid: 200, high: 450 } },

  // ASIE
  { code: "JP", name: "Japon", region: "AS", continent: "Asie", power: 130, water: "safe", budget: { low: 60, mid: 150, high: 350 }, customs: ["Codeine", "Couteaux"] },
  { code: "KR", name: "Corée du Sud", region: "AS", continent: "Asie", power: 129, water: "safe", budget: { low: 55, mid: 130, high: 300 } },
  { code: "SG", name: "Singapour", region: "AS", continent: "Asie", power: 130, water: "safe", budget: { low: 70, mid: 180, high: 400 }, customs: ["Chewing-gum"] },
  { code: "TH", name: "Thaïlande", region: "AS", continent: "Asie", power: 70, water: "unsafe", budget: { low: 30, mid: 70, high: 180 }, customs: ["E-cigarette"] },
  { code: "VN", name: "Vietnam", region: "AS", continent: "Asie", power: 65, water: "unsafe", budget: { low: 25, mid: 60, high: 150 }, customs: ["Drones"] },
  { code: "ID", name: "Indonésie", region: "AS", continent: "Asie", power: 68, water: "unsafe", budget: { low: 25, mid: 60, high: 150 }, customs: ["Drogues (Mort)"] },
  { code: "BA", name: "Bali (Indonésie)", region: "AS", continent: "Asie", power: 68, water: "unsafe", budget: { low: 35, mid: 90, high: 250 }, customs: ["Drogues (Mort)"] },
  { code: "CN", name: "Chine", region: "AS", continent: "Asie", power: 80, water: "unsafe", budget: { low: 45, mid: 100, high: 250 }, customs: ["VPN"] },
  { code: "HK", name: "Hong Kong", region: "AS", continent: "Asie", power: 115, water: "safe", budget: { low: 70, mid: 160, high: 400 } },
  { code: "TW", name: "Taïwan", region: "AS", continent: "Asie", power: 105, water: "safe", budget: { low: 50, mid: 110, high: 250 } },
  { code: "IN", name: "Inde", region: "AS", continent: "Asie", power: 60, water: "unsafe", budget: { low: 25, mid: 50, high: 140 } },
  { code: "NP", name: "Népal", region: "AS", continent: "Asie", power: 55, water: "unsafe", budget: { low: 20, mid: 50, high: 120 } },
  { code: "LK", name: "Sri Lanka", region: "AS", continent: "Asie", power: 42, water: "unsafe", budget: { low: 25, mid: 60, high: 150 } },
  { code: "MY", name: "Malaisie", region: "AS", continent: "Asie", power: 110, water: "unsafe", budget: { low: 30, mid: 70, high: 180 } },
  { code: "PH", name: "Philippines", region: "AS", continent: "Asie", power: 66, water: "unsafe", budget: { low: 35, mid: 80, high: 180 } },
  { code: "KH", name: "Cambodge", region: "AS", continent: "Asie", power: 50, water: "unsafe", budget: { low: 25, mid: 55, high: 140 } },
  { code: "LA", name: "Laos", region: "AS", continent: "Asie", power: 45, water: "unsafe", budget: { low: 25, mid: 50, high: 130 } },
  { code: "MN", name: "Mongolie", region: "AS", continent: "Asie", power: 60, water: "unsafe", budget: { low: 35, mid: 80, high: 180 } },
  { code: "KZ", name: "Kazakhstan", region: "AS", continent: "Asie", power: 70, water: "unsafe", budget: { low: 40, mid: 90, high: 200 } },
  { code: "UZ", name: "Ouzbékistan", region: "AS", continent: "Asie", power: 65, water: "unsafe", budget: { low: 30, mid: 70, high: 150 }, customs: ["Psychotropes"] },
  { code: "PK", name: "Pakistan", region: "AS", continent: "Asie", power: 45, water: "unsafe", budget: { low: 25, mid: 60, high: 140 }, customs: ["Alcool"] },
  { code: "BD", name: "Bangladesh", region: "AS", continent: "Asie", power: 50, water: "unsafe", budget: { low: 25, mid: 60, high: 140 } },
  { code: "MV", name: "Maldives", region: "AS", continent: "Asie", power: 60, water: "unsafe", budget: { low: 80, mid: 200, high: 600 }, customs: ["Alcool", "Porc"] },

  // MOYEN-ORIENT / AFRIQUE
  { code: "AE", name: "Dubaï (EAU)", region: "ME", continent: "Afrique / M-O", power: 110, water: "safe", budget: { low: 70, mid: 180, high: 500 }, customs: ["Codeine"] },
  { code: "QA", name: "Qatar", region: "ME", continent: "Afrique / M-O", power: 100, water: "safe", budget: { low: 80, mid: 200, high: 500 }, customs: ["Alcool", "Porc"] },
  { code: "SA", name: "Arabie Saoudite", region: "ME", continent: "Afrique / M-O", power: 85, water: "unsafe", budget: { low: 70, mid: 160, high: 400 }, customs: ["Alcool", "Porc"] },
  { code: "IL", name: "Israël", region: "ME", continent: "Afrique / M-O", power: 105, water: "safe", budget: { low: 70, mid: 180, high: 400 } },
  { code: "JO", name: "Jordanie", region: "ME", continent: "Afrique / M-O", power: 75, water: "unsafe", budget: { low: 45, mid: 110, high: 250 }, customs: ["Drones"] },
  { code: "OM", name: "Oman", region: "ME", continent: "Afrique / M-O", power: 88, water: "unsafe", budget: { low: 60, mid: 150, high: 350 } },
  { code: "KW", name: "Koweït", region: "ME", continent: "Afrique / M-O", power: 95, water: "safe", budget: { low: 70, mid: 170, high: 400 } },
  { code: "BH", name: "Bahreïn", region: "ME", continent: "Afrique / M-O", power: 92, water: "safe", budget: { low: 70, mid: 160, high: 400 } },
  { code: "LB", name: "Liban", region: "ME", continent: "Afrique / M-O", power: 60, water: "unsafe", budget: { low: 40, mid: 100, high: 200 } },
  { code: "MA", name: "Maroc", region: "AF", continent: "Afrique / M-O", power: 65, water: "unsafe", budget: { low: 30, mid: 70, high: 180 }, customs: ["Drones"] },
  { code: "TN", name: "Tunisie", region: "AF", continent: "Afrique / M-O", power: 60, water: "unsafe", budget: { low: 30, mid: 65, high: 160 }, customs: ["Dinars (Export)"] },
  { code: "EG", name: "Égypte", region: "AF", continent: "Afrique / M-O", power: 50, water: "unsafe", budget: { low: 30, mid: 70, high: 180 }, customs: ["Drones"] },
  { code: "ZA", name: "Afrique du Sud", region: "AF", continent: "Afrique / M-O", power: 95, water: "unsafe", budget: { low: 45, mid: 100, high: 250 } },
  { code: "ZN", name: "Zanzibar (Tanzanie)", region: "AF", continent: "Afrique / M-O", power: 52, water: "unsafe", budget: { low: 50, mid: 120, high: 300 }, health: { yellowFever: true }, customs: ["Sacs plastiques"] },
  { code: "KE", name: "Kenya", region: "AF", continent: "Afrique / M-O", power: 55, water: "unsafe", budget: { low: 60, mid: 140, high: 350 }, health: { yellowFever: true }, customs: ["Sacs plastiques"] },
  { code: "TZ", name: "Tanzanie", region: "AF", continent: "Afrique / M-O", power: 52, water: "unsafe", budget: { low: 60, mid: 140, high: 350 }, health: { yellowFever: true }, customs: ["Sacs plastiques"] },
  { code: "NA", name: "Namibie", region: "AF", continent: "Afrique / M-O", power: 80, water: "safe", budget: { low: 60, mid: 150, high: 350 } },
  { code: "SN", name: "Sénégal", region: "AF", continent: "Afrique / M-O", power: 58, water: "unsafe", budget: { low: 35, mid: 80, high: 180 }, health: { yellowFever: true } },
  { code: "CI", name: "Côte d'Ivoire", region: "AF", continent: "Afrique / M-O", power: 56, water: "unsafe", budget: { low: 40, mid: 90, high: 200 }, health: { yellowFever: true } },
  { code: "CM", name: "Cameroun", region: "AF", continent: "Afrique / M-O", power: 50, water: "unsafe", budget: { low: 35, mid: 80, high: 180 }, health: { yellowFever: true } },
  { code: "MU", name: "Île Maurice", region: "AF", continent: "Afrique / M-O", power: 90, water: "unsafe", budget: { low: 60, mid: 150, high: 350 } },
  { code: "MG", name: "Madagascar", region: "AF", continent: "Afrique / M-O", power: 50, water: "unsafe", budget: { low: 30, mid: 70, high: 160 } },
  { code: "SC", name: "Seychelles", region: "AF", continent: "Afrique / M-O", power: 85, water: "safe", budget: { low: 100, mid: 250, high: 600 } },
  { code: "RW", name: "Rwanda", region: "AF", continent: "Afrique / M-O", power: 60, water: "unsafe", budget: { low: 40, mid: 90, high: 200 }, health: { yellowFever: true } },
  { code: "UG", name: "Ouganda", region: "AF", continent: "Afrique / M-O", power: 55, water: "unsafe", budget: { low: 35, mid: 80, high: 180 }, health: { yellowFever: true } },
  { code: "GH", name: "Ghana", region: "AF", continent: "Afrique / M-O", power: 58, water: "unsafe", budget: { low: 35, mid: 80, high: 180 }, health: { yellowFever: true } },
  { code: "NG", name: "Nigéria", region: "AF", continent: "Afrique / M-O", power: 45, water: "unsafe", budget: { low: 40, mid: 90, high: 200 }, health: { yellowFever: true } },
  { code: "BW", name: "Botswana", region: "AF", continent: "Afrique / M-O", power: 75, water: "safe", budget: { low: 60, mid: 150, high: 400 } },
  { code: "DZ", name: "Algérie", region: "AF", continent: "Afrique / M-O", power: 55, water: "unsafe", budget: { low: 30, mid: 70, high: 160 }, customs: ["Jumelles"] },

  // OCÉANIE
  { code: "AU", name: "Australie", region: "OC", continent: "Océanie", power: 120, water: "safe", budget: { low: 70, mid: 160, high: 350 }, customs: ["Terre", "Nourriture"] },
  { code: "NZ", name: "Nouvelle-Zélande", region: "OC", continent: "Océanie", power: 119, water: "safe", budget: { low: 70, mid: 160, high: 350 }, customs: ["Terre"] },
  { code: "FJ", name: "Fidji", region: "OC", continent: "Océanie", power: 80, water: "unsafe", budget: { low: 50, mid: 120, high: 300 } },
  { code: "PF", name: "Polynésie Fr.", region: "OC", continent: "Océanie", power: 128, water: "safe", budget: { low: 90, mid: 250, high: 600 } },
  { code: "NC", name: "Nouvelle-Calédonie", region: "OC", continent: "Océanie", power: 128, water: "safe", budget: { low: 80, mid: 200, high: 450 } },
].sort((a, b) => a.name.localeCompare(b.name));

// ... (Rest of the file: Components BudgetView, InsuranceView, etc. remains identical to V4.0 logic)

const NavBar = ({ currentView, setCurrentView, t }) => (
  <nav className="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-100 py-2 px-6 flex justify-between items-center z-50 sm:top-0 sm:bottom-auto sm:border-b sm:border-t-0 shadow-lg sm:shadow-sm">
    <button 
      onClick={() => setCurrentView('home')}
      className={`flex flex-col items-center gap-1 text-[10px] sm:text-xs font-bold transition-colors ${currentView === 'home' ? 'text-blue-600' : 'text-slate-400 hover:text-slate-600'}`}
    >
      <Home size={24} strokeWidth={currentView === 'home' ? 2.5 : 2} />
      {t.nav_home}
    </button>
    <button 
      onClick={() => setCurrentView('budget')}
      className={`flex flex-col items-center gap-1 text-[10px] sm:text-xs font-bold transition-colors ${currentView === 'budget' ? 'text-blue-600' : 'text-slate-400 hover:text-slate-600'}`}
    >
      <Wallet size={24} strokeWidth={currentView === 'budget' ? 2.5 : 2} />
      {t.nav_budget}
    </button>
    <div className="relative -top-6 sm:static sm:top-auto">
      <div className="bg-blue-600 p-3 rounded-full shadow-blue-300 shadow-lg cursor-pointer" onClick={() => setCurrentView('home')}>
         <Plane size={24} className="text-white" />
      </div>
    </div>
    <button 
      onClick={() => setCurrentView('insurance')}
      className={`flex flex-col items-center gap-1 text-[10px] sm:text-xs font-bold transition-colors ${currentView === 'insurance' ? 'text-blue-600' : 'text-slate-400 hover:text-slate-600'}`}
    >
      <Umbrella size={24} strokeWidth={currentView === 'insurance' ? 2.5 : 2} />
      {t.nav_insurance}
    </button>
    <button 
      onClick={() => setCurrentView('help')}
      className={`flex flex-col items-center gap-1 text-[10px] sm:text-xs font-bold transition-colors ${currentView === 'help' ? 'text-blue-600' : 'text-slate-400 hover:text-slate-600'}`}
    >
      <HelpCircle size={24} strokeWidth={currentView === 'help' ? 2.5 : 2} />
      {t.nav_help}
    </button>
  </nav>
);

const BudgetView = ({ t, countries }) => {
  const [dest, setDest] = useState("");
  const [days, setDays] = useState(7);
  const [style, setStyle] = useState("mid");
  const [result, setResult] = useState(null);

  const calculateBudget = () => {
    if(!dest) return;
    const country = countries.find(c => c.code === dest);
    if(!country || !country.budget) return;

    const dailyCost = country.budget[style];
    const total = dailyCost * days;
    
    setResult({
      total: total,
      daily: dailyCost,
      accom: Math.round(dailyCost * 0.45),
      food: Math.round(dailyCost * 0.30),
      transport: Math.round(dailyCost * 0.25)
    });
  };

  return (
    <div className="w-full max-w-lg mx-auto animate-in fade-in duration-500 pt-6 pb-32">
      <h2 className="text-2xl font-bold text-slate-800 mb-2">{t.budget_title}</h2>
      <p className="text-slate-500 text-sm mb-6">{t.budget_desc}</p>

      <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 space-y-4">
        <div>
          <label className="block text-xs font-bold text-slate-500 uppercase mb-2">{t.label_destination}</label>
          <select 
            className="w-full p-3 rounded-xl border border-slate-200 bg-slate-50"
            value={dest}
            onChange={(e) => setDest(e.target.value)}
          >
            <option value="">{t.placeholder_select}</option>
            {countries.map(c => <option key={c.code} value={c.code}>{c.name}</option>)}
          </select>
        </div>

        <div className="grid grid-cols-2 gap-4">
           <div>
            <label className="block text-xs font-bold text-slate-500 uppercase mb-2">Durée (Jours)</label>
            <input 
              type="number" 
              className="w-full p-3 rounded-xl border border-slate-200 bg-slate-50"
              value={days}
              onChange={(e) => setDays(parseInt(e.target.value) || 0)}
            />
           </div>
           <div>
             <label className="block text-xs font-bold text-slate-500 uppercase mb-2">Style</label>
             <select 
                className="w-full p-3 rounded-xl border border-slate-200 bg-slate-50 text-sm"
                value={style}
                onChange={(e) => setStyle(e.target.value)}
              >
               <option value="low">{t.style_backpacker}</option>
               <option value="mid">{t.style_standard}</option>
               <option value="high">{t.style_luxury}</option>
             </select>
           </div>
        </div>

        <button 
          onClick={calculateBudget}
          className="w-full bg-blue-600 text-white font-bold py-3 rounded-xl hover:bg-blue-700 transition-colors"
        >
          Calculer
        </button>
      </div>

      {result && (
        <div className="mt-6 bg-slate-900 text-white p-6 rounded-2xl shadow-xl animate-in slide-in-from-bottom-4">
          <div className="text-center mb-6">
            <p className="text-slate-400 text-xs uppercase font-bold">{t.budget_total}</p>
            <div className="text-4xl font-extrabold text-white mt-2">
              {result.total} €
            </div>
            <p className="text-slate-400 text-sm">~ {result.daily} € / {t.budget_per_day}</p>
          </div>

          <div className="space-y-3 border-t border-slate-800 pt-4">
            <p className="text-xs text-slate-500 font-bold uppercase mb-2">{t.budget_breakdown}</p>
            <div className="flex items-center justify-between text-sm">
              <div className="flex items-center gap-2 text-slate-300"><Bed size={16} /> {t.cat_accom}</div>
              <span className="font-bold">{result.accom} €</span>
            </div>
            <div className="flex items-center justify-between text-sm">
              <div className="flex items-center gap-2 text-slate-300"><Utensils size={16} /> {t.cat_food}</div>
              <span className="font-bold">{result.food} €</span>
            </div>
             <div className="flex items-center justify-between text-sm">
              <div className="flex items-center gap-2 text-slate-300"><Bus size={16} /> {t.cat_transport}</div>
              <span className="font-bold">{result.transport} €</span>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

const InsuranceView = ({ t }) => (
  <div className="w-full max-w-lg mx-auto animate-in fade-in duration-500 pt-6 pb-32">
    <h2 className="text-2xl font-bold text-slate-800 mb-2">{t.ins_title}</h2>
    <p className="text-slate-500 text-sm mb-6">{t.ins_desc}</p>

    <div className="space-y-4">
      {/* Carte Bancaire */}
      <div className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm">
        <div className="flex items-start gap-4">
           <div className="bg-slate-100 p-3 rounded-xl text-slate-600">
             <Wallet size={24} />
           </div>
           <div>
             <h3 className="font-bold text-slate-800 text-lg">{t.ins_card_bank}</h3>
             <p className="text-sm text-slate-500 mt-2 leading-relaxed">
               {t.ins_card_bank_desc}
             </p>
           </div>
        </div>
      </div>

      {/* Assurance Spécialisée */}
      <div className="bg-white p-6 rounded-2xl border-2 border-blue-100 shadow-md relative overflow-hidden">
        <div className="absolute top-0 right-0 bg-blue-600 text-white text-[10px] font-bold px-2 py-1 rounded-bl-lg">
          RECOMMANDÉ
        </div>
        <div className="flex items-start gap-4">
           <div className="bg-blue-50 p-3 rounded-xl text-blue-600">
             <ShieldCheck size={24} />
           </div>
           <div>
             <h3 className="font-bold text-slate-800 text-lg">{t.ins_card_spec}</h3>
             <p className="text-sm text-slate-500 mt-2 leading-relaxed">
               {t.ins_card_spec_desc}
             </p>
             <button className="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold py-2 rounded-lg transition-colors">
               {t.ins_btn_compare}
             </button>
           </div>
        </div>
      </div>
    </div>
  </div>
);

const FeedbackView = ({ t }) => (
  <div className="w-full max-w-lg mx-auto animate-in fade-in duration-500 pt-6 pb-32">
    <h2 className="text-2xl font-bold text-slate-800 mb-2">{t.help_title}</h2>
    <p className="text-slate-500 text-sm mb-6">{t.help_desc}</p>

    <form className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 space-y-4" onSubmit={(e) => { e.preventDefault(); alert(t.feedback_success); }}>
      <div>
        <label className="block text-xs font-bold text-slate-500 uppercase mb-2">{t.label_name}</label>
        <input type="text" className="w-full p-3 rounded-xl border border-slate-200 bg-slate-50" required />
      </div>
      <div>
        <label className="block text-xs font-bold text-slate-500 uppercase mb-2">{t.label_email}</label>
        <input type="email" className="w-full p-3 rounded-xl border border-slate-200 bg-slate-50" required />
      </div>
      <div>
        <label className="block text-xs font-bold text-slate-500 uppercase mb-2">{t.label_message}</label>
        <textarea className="w-full p-3 rounded-xl border border-slate-200 bg-slate-50 h-32" required></textarea>
      </div>
      <button type="submit" className="w-full bg-slate-800 text-white font-bold py-3 rounded-xl hover:bg-slate-900 transition-colors flex items-center justify-center gap-2">
        <MessageSquare size={18} />
        {t.btn_send}
      </button>
    </form>
  </div>
);

// --- COMPOSANTS UI EXISTANTS ---
const CountrySelect = ({ value, onChange, placeholder, excludeCode }) => {
  const grouped = (list) => list.reduce((groups, country) => {
    const continent = country.continent;
    if (!groups[continent]) groups[continent] = [];
    groups[continent].push(country);
    return groups;
  }, {});
  
  const groups = grouped(countries);
  const continentOrder = ["Europe", "Asie", "Amériques", "Afrique / M-O", "Océanie"];

  return (
    <select 
      className="w-full bg-slate-50 border border-slate-200 text-slate-700 font-sans font-medium rounded-xl p-4 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all appearance-none cursor-pointer hover:bg-slate-100"
      value={value}
      onChange={onChange}
    >
      <option value="">{placeholder}</option>
      {continentOrder.map(continent => (
        groups[continent] && (
          <optgroup key={continent} label={continent}>
            {groups[continent]
              .filter(c => c.code !== excludeCode)
              .map(c => (
                <option key={c.code} value={c.code} className="font-sans">{c.name}</option>
              ))
            }
          </optgroup>
        )
      ))}
    </select>
  );
};

const PassportPower = ({ score, maxScore = 150, t }) => {
  const percentage = Math.min((score / maxScore) * 100, 100);
  let tier = "Bronze";
  let colorClass = "bg-amber-600";
  let trophyColor = "text-slate-300";
  if (score > 100) { tier = "Silver"; colorClass = "bg-slate-400"; trophyColor = "text-slate-300"; }
  if (score > 125) { tier = "Gold"; colorClass = "bg-yellow-500"; trophyColor = "text-yellow-400"; }

  return (
    <div className="bg-slate-900 text-white rounded-2xl p-6 mb-6 relative overflow-hidden shadow-xl transform transition-all hover:scale-[1.01]">
      <div className="absolute top-0 right-0 p-4 opacity-10"><Globe size={120} /></div>
      <div className="relative z-10">
        <div className="flex justify-between items-start mb-4">
          <div>
            <h3 className="text-slate-400 text-xs uppercase font-bold tracking-widest">{t.passport_power}</h3>
            <div className="text-4xl font-extrabold flex items-center gap-3 mt-2"><Trophy size={32} className={trophyColor} />{score} <span className="text-lg text-slate-500 font-normal">/ {maxScore}</span></div>
          </div>
          <div className={`px-4 py-1.5 rounded-full text-xs font-black text-slate-900 uppercase tracking-wide shadow-lg ${colorClass}`}>{tier} Tier</div>
        </div>
        <div className="w-full bg-slate-800 h-3 rounded-full overflow-hidden border border-slate-700"><div className={`h-full ${colorClass} transition-all duration-1000 ease-out`} style={{ width: `${percentage}%` }}></div></div>
        <p className="text-xs text-slate-400 mt-4 flex items-center gap-2"><CheckCircle size={12} className="text-green-500" />{t.access_text} {score} {t.countries_text}.</p>
      </div>
    </div>
  );
};

const DocumentCard = ({ title, status, description, cost, isMandatory, link, t }) => {
   const getStatusColor = () => {
    switch(status) {
      case 'ok': return 'bg-emerald-50 text-emerald-600 border-emerald-100';
      case 'alert': return 'bg-amber-50 text-amber-600 border-amber-100';
      case 'error': return 'bg-red-50 text-red-600 border-red-100';
      default: return 'bg-blue-50 text-blue-600 border-blue-100';
    }
  };
  const getIcon = () => {
    switch(status) {
      case 'ok': return <CheckCircle size={20} />;
      case 'alert': return <AlertTriangle size={20} />;
      case 'error': return <ShieldCheck size={20} />;
      default: return <Info size={20} />;
    }
  };
  return (
    <div className="bg-white border border-slate-100 rounded-xl p-5 mb-3 shadow-sm hover:shadow-md transition-all duration-300 flex flex-row items-start gap-4 group">
      <div className={`p-3 rounded-xl shrink-0 border ${getStatusColor()} transition-colors`}>{getIcon()}</div>
      <div className="flex-1 w-full">
        <div className="flex justify-between items-start"><h4 className="font-bold text-slate-800 text-lg group-hover:text-blue-600 transition-colors">{title}</h4>{isMandatory && <span className="bg-rose-50 text-rose-600 border border-rose-100 text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wider">{t.doc_mandatory}</span>}</div>
        <p className="text-sm text-slate-500 mt-1 leading-relaxed">{description}</p>
        <div className="flex flex-wrap items-center gap-3 mt-3">
          {cost && <div className="inline-flex items-center text-xs font-bold text-slate-700 bg-slate-50 px-2.5 py-1 rounded-md border border-slate-200">{t.cost}: {cost}</div>}
          {link && <a href={link} target="_blank" rel="noopener noreferrer" className="inline-flex items-center gap-1.5 text-xs font-bold text-white bg-blue-600 hover:bg-blue-700 px-3 py-1.5 rounded-md transition-colors shadow-sm">{t.btn_official_link} <ExternalLink size={12} /></a>}
        </div>
      </div>
    </div>
  );
};

const HealthCard = ({ water, vaccine, t }) => (
  <div className="bg-white border border-slate-100 rounded-xl p-5 mb-3 shadow-sm flex flex-row gap-4 items-start">
    <div className="p-3 rounded-xl shrink-0 border bg-teal-50 text-teal-600 border-teal-100"><Stethoscope size={20} /></div>
    <div className="flex-1">
      <h4 className="font-bold text-slate-800 text-lg mb-2">{t.health_title}</h4>
      <div className="space-y-2">
        <div className={`flex items-center gap-2 text-sm font-medium ${water === 'safe' ? 'text-green-600' : 'text-red-500'}`}><Droplets size={16} />{water === 'safe' ? t.water_safe : t.water_unsafe}</div>
        {vaccine && <div className="flex items-center gap-2 text-sm font-medium text-amber-600"><AlertTriangle size={16} />{t.vaccine_mandatory} <span className="font-bold">{vaccine}</span></div>}
      </div>
    </div>
  </div>
);

const CustomsCard = ({ items, t }) => (
  <div className="bg-white border border-rose-100 rounded-xl p-5 mb-3 shadow-sm flex flex-row gap-4 items-start">
    <div className="p-3 rounded-xl shrink-0 border bg-rose-50 text-rose-600 border-rose-100"><Siren size={20} /></div>
    <div className="flex-1">
      <h4 className="font-bold text-slate-800 text-lg mb-2">{t.customs_title}</h4>
      <p className="text-xs font-bold uppercase text-rose-500 mb-2">{t.forbidden_items}</p>
      <ul className="list-disc list-inside text-sm text-slate-600 space-y-1">{items.map((item, i) => <li key={i}>{item}</li>)}</ul>
    </div>
  </div>
);

const ActionButton = ({ icon: Icon, title, subtitle, colorClass, link, isExternal }) => (
  <a href={link} target={isExternal ? "_blank" : "_self"} rel={isExternal ? "noopener noreferrer" : ""} className="flex items-center justify-between p-4 bg-white border border-slate-200 rounded-xl hover:border-blue-400 hover:shadow-lg hover:-translate-y-1 transition-all duration-300 group cursor-pointer">
    <div className="flex items-center gap-4"><div className={`${colorClass} p-3 rounded-lg bg-opacity-10`}><Icon size={24} className={colorClass.replace('bg-', 'text-')} /></div><div className="text-left"><div className="font-bold text-slate-800">{title}</div><div className="text-xs text-slate-500">{subtitle}</div></div></div><ExternalLink size={16} className="text-slate-300 group-hover:text-blue-500 transition-colors" />
  </a>
);

const ServiceCard = ({ icon: Icon, title, desc, colorClass, link }) => (
  <a href={link} target="_blank" rel="noreferrer" className="bg-white border border-slate-100 rounded-xl p-4 shadow-sm hover:shadow-md hover:border-blue-300 transition-all duration-300 flex items-center gap-4 group cursor-pointer">
    <div className={`p-3 rounded-xl shrink-0 ${colorClass} bg-opacity-10`}><Icon size={24} className={colorClass.replace('bg-', 'text-')} /></div>
    <div className="flex-1"><div className="flex justify-between items-center"><h4 className="font-bold text-slate-800 group-hover:text-blue-600 transition-colors">{title}</h4><ExternalLink size={14} className="text-slate-300 group-hover:text-blue-500" /></div><p className="text-xs text-slate-500 mt-1">{desc}</p></div>
  </a>
);

const OfferCountdown = ({ t }) => {
  const [timeLeft, setTimeLeft] = useState(600);
  useEffect(() => { const timer = setInterval(() => { setTimeLeft((prev) => (prev > 0 ? prev - 1 : 0)); }, 1000); return () => clearInterval(timer); }, []);
  const formatTime = (seconds) => { const m = Math.floor(seconds / 60); const s = seconds % 60; return `${m < 10 ? '0' : ''}${m}:${s < 10 ? '0' : ''}${s}`; };
  return <div className="flex items-center justify-center gap-2 mb-4 text-sm font-medium text-rose-600 animate-pulse"><Clock size={16} /><span>{t.offer_expires} {formatTime(timeLeft)}</span></div>;
};

// --- APPLICATION PRINCIPALE ---

export default function App() {
  const [lang, setLang] = useState('FR');
  const [currentView, setCurrentView] = useState('home');
  const [step, setStep] = useState(0); 
  const [formData, setFormData] = useState({ nationality: "FR", origin: "FR", destination: "", age: 25, startDate: new Date().toISOString().split('T')[0], endDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0] });
  const [result, setResult] = useState(null);

  // Auto-detection de la langue du navigateur
  useEffect(() => {
    const userLang = navigator.language || navigator.userLanguage; 
    const code = userLang.split('-')[0].toUpperCase(); // ex: 'en-US' -> 'EN'
    
    const supported = ['FR', 'EN', 'ES', 'ZH', 'JA', 'KO'];
    
    if (supported.includes(code)) {
      setLang(code);
    } else {
      setLang('EN');
    }
  }, []);

  const t = translations[lang];

  const handleSearch = () => {
     if (!formData.destination) return alert(t.missing_dest_error);
     if (formData.origin === formData.destination) return alert(t.origin_same_dest_error);

     const start = new Date(formData.startDate);
     const end = new Date(formData.endDate);
     if (end <= start) return alert("La date de retour doit être après la date de départ.");

     const diffTime = Math.abs(end - start);
     const durationDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
     const travelerAge = parseInt(formData.age);

     setStep(1);
     setTimeout(() => {
        const passportInfo = countries.find(c => c.code === formData.nationality);
        const originInfo = countries.find(c => c.code === formData.origin);
        const destInfo = countries.find(c => c.code === formData.destination);

        let docs = [];
        let isEuToEu = passportInfo.region === 'EU' && destInfo.region === 'EU';

        if (isEuToEu) {
            docs.push({ title: "Carte Nationale d'Identité (CNI)", status: "ok", description: "Suffisant pour les ressortissants UE.", mandatory: true, cost: "Gratuit" });
        } else {
            docs.push({ title: "Passeport Valide", status: "ok", description: "Doit être valide au moins 6 mois après le retour.", mandatory: true, cost: "Variable" });
        }

        if (travelerAge < 18) {
            docs.push({ title: "Autorisation de Sortie du Territoire (AST)", status: "alert", description: "Obligatoire si le mineur voyage sans l'un de ses parents.", mandatory: true, cost: "Gratuit", link: "https://www.service-public.fr/particuliers/vosdroits/F1359" });
        }

        // Logique Visas (Simplifiée pour la démo mais extensible)
        if (destInfo.code === 'US') {
            docs.push({ title: "ESTA USA", status: "alert", description: "Autorisation obligatoire à remplir au moins 72h avant.", mandatory: true, cost: "21 USD", link: "https://esta.cbp.dhs.gov/" });
        } else if (destInfo.code === 'CA') {
            docs.push({ title: "AVE Canada", status: "alert", description: "Autorisation de voyage électronique requise.", mandatory: true, cost: "7 CAD", link: "https://www.canada.ca/fr/immigration-refugies-citoyennete/services/visiter-canada/ave.html" });
        } else if (destInfo.code === 'AU') {
            docs.push({ title: "eVisitor (subclass 651)", status: "alert", description: "Visa touriste gratuit pour Européens.", mandatory: true, cost: "Gratuit", link: "https://immi.homeaffairs.gov.au/visas/getting-a-visa/visa-listing/evisitor-651" });
        } else if (destInfo.code === 'BA') {
            docs.push({ title: "Visa à l'arrivée (VOA)", status: "alert", description: "Payable en ligne ou à l'arrivée. Valable 30 jours.", mandatory: true, cost: "~35€", link: "https://molina.imigrasi.go.id/" });
            docs.push({ title: "Taxe 'Love Bali'", status: "alert", description: "Taxe touristique obligatoire.", mandatory: true, cost: "~9€", link: "https://lovebali.baliprov.go.id/" });
        } else if (destInfo.code === 'ZN') {
             docs.push({title: "Visa Tanzanie / Zanzibar",status: "error",description: "E-Visa ou visa à l'arrivée requis.",mandatory: true,cost: "50 USD",link: "https://eservices.immigration.go.tz/visa/"});
        } else if (destInfo.code === 'CQ') {
             docs.push({title: "Taxe de Tourisme (Visitax)",status: "alert",description: "Taxe obligatoire pour l'état du Quintana Roo.",mandatory: true,cost: "~11 USD",link: "https://www.visitax.gob.mx/"});
        } else if (destInfo.code === 'AE') {
             docs.push({title: "Visa Touristique (Gratuit)",status: "ok",description: "Tampon gratuit de 30 jours.",mandatory: true,cost: "Gratuit"});
             docs.push({title: "Taxe de Séjour",status: "info",description: "Taxe obligatoire à l'hôtel.",mandatory: true,cost: "~3-5€ /nuit"});
        }

        const flightLink = generateFlightLink(formData.origin, formData.destination, formData.startDate, formData.endDate);
        const hotelLink = generateHotelLink(destInfo.name, formData.startDate, formData.endDate);

        setResult({
            passportPower: passportInfo.power,
            destinationName: destInfo.name,
            originName: originInfo.name,
            documents: docs,
            health: destInfo.health,
            customs: destInfo.customs,
            water: destInfo.water,
            duration: durationDays,
            flightLink: flightLink,
            hotelLink: hotelLink
        });
        setStep(2);
     }, 1500);
  };

  return (
    <div className="min-h-screen bg-slate-50 font-sans text-slate-900 flex flex-col sm:pt-20">
      
      {/* NAVIGATION */}
      <NavBar currentView={currentView} setCurrentView={setCurrentView} t={t} />

      <main className="flex-grow px-4 w-full max-w-5xl mx-auto">
        
        {/* TITLE HEADER (Visible only on Home) */}
        {currentView === 'home' && step === 0 && (
           <div className="text-center mb-10 mt-8 animate-in fade-in">
              <h1 className="text-3xl sm:text-4xl font-extrabold text-slate-800 mb-3 tracking-tight">
                {t.hero_title} <span className="text-blue-600">{t.hero_highlight}</span>.
              </h1>
              <p className="text-slate-500 text-base sm:text-lg">{t.hero_desc}</p>
           </div>
        )}

        {/* VIEW SWITCHING */}
        {currentView === 'budget' && <BudgetView t={t} countries={countries} />}
        {currentView === 'insurance' && <InsuranceView t={t} />}
        {currentView === 'help' && <FeedbackView t={t} />}

        {/* HOME VIEW CONTENT */}
        {currentView === 'home' && (
            <>
                {step === 0 && (
                    <div className="bg-white p-6 sm:p-8 rounded-3xl shadow-xl border border-slate-100 max-w-lg mx-auto animate-in slide-in-from-bottom-4">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div className="mb-4 md:mb-0"><label className="block text-xs font-bold text-slate-500 uppercase mb-2">{t.label_nationality}</label><CountrySelect value={formData.nationality} onChange={(e) => setFormData({...formData, nationality: e.target.value})} placeholder={t.placeholder_select} /></div>
                            <div><label className="block text-xs font-bold text-slate-500 uppercase mb-2">{t.label_origin}</label><CountrySelect value={formData.origin} onChange={(e) => setFormData({...formData, origin: e.target.value})} placeholder={t.placeholder_select} /></div>
                        </div>
                        <div className="mb-4"><label className="block text-xs font-bold text-slate-500 uppercase mb-2">{t.label_destination}</label><CountrySelect value={formData.destination} onChange={(e) => setFormData({...formData, destination: e.target.value})} placeholder={t.placeholder_select} excludeCode={formData.origin} /></div>
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                             <div><label className="block text-xs font-bold text-slate-500 uppercase mb-2">{t.label_start_date}</label><input type="date" className="w-full p-3 rounded-xl border border-slate-200 bg-slate-50" value={formData.startDate} onChange={(e) => setFormData({...formData, startDate: e.target.value})} /></div>
                             <div><label className="block text-xs font-bold text-slate-500 uppercase mb-2">{t.label_end_date}</label><input type="date" className="w-full p-3 rounded-xl border border-slate-200 bg-slate-50" value={formData.endDate} onChange={(e) => setFormData({...formData, endDate: e.target.value})} /></div>
                        </div>
                        <InputField label={t.label_age} icon={Trophy}><input type="number" className="w-full p-3 rounded-xl border border-slate-200 bg-slate-50" value={formData.age} onChange={(e) => setFormData({...formData, age: e.target.value})} /></InputField>
                        <button onClick={handleSearch} className="w-full bg-blue-600 text-white font-bold py-4 rounded-xl hover:bg-blue-700 transition-transform active:scale-95 flex justify-center items-center gap-2">{t.btn_analyze} <ArrowRight size={20}/></button>
                    </div>
                )}

                {step === 1 && (
                    <div className="flex flex-col items-center justify-center mt-20">
                        <div className="animate-spin mb-4 text-blue-600"><Plane size={48}/></div>
                        <h2 className="text-xl font-bold">{t.loading_title}</h2>
                        <p className="text-slate-400">{t.loading_text}</p>
                    </div>
                )}

                {step === 2 && result && (
                    <div className="max-w-2xl mx-auto pb-24 animate-in fade-in">
                         <button onClick={() => setStep(0)} className="mb-6 text-sm font-bold text-slate-500 hover:text-blue-600">&larr; {t.result_back}</button>
                         <PassportPower score={result.passportPower} t={t} />
                         <div className="space-y-4 mb-10">
                            {result.documents.map((d, i) => <DocumentCard key={i} {...d} t={t}/>)}
                            <HealthCard water={result.water || 'unsafe'} vaccine={result.health?.yellowFever ? 'Fièvre Jaune' : null} t={t} />
                            {result.customs && <CustomsCard items={result.customs} t={t} />}
                         </div>
                         <div className="mb-10"><h3 className="text-xl font-bold text-slate-800 mb-5">{t.services_title}</h3><div className="grid grid-cols-1 md:grid-cols-2 gap-4"><ServiceCard icon={Wifi} title={t.service_esim} desc={t.service_esim_desc} colorClass="bg-teal-500 text-teal-500" link={`https://www.airalo.com/?ref=${AFFILIATE_CONFIG.esim_id}`} /><ServiceCard icon={Ticket} title={t.service_activities} desc={t.service_activities_desc} colorClass="bg-purple-500 text-purple-500" link={`https://www.getyourguide.com/?partner_id=${AFFILIATE_CONFIG.activities_id}`} /></div></div>
                         <div className="mb-32"><h3 className="text-xl font-bold text-slate-800 mb-5 flex justify-between items-end">{t.action_title}</h3><OfferCountdown t={t} /><div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8"><ActionButton icon={Plane} title={t.action_flight} subtitle="" colorClass="bg-sky-500 text-sky-500" link={result.flightLink} isExternal={true} /><ActionButton icon={MapPin} title={t.action_hotel} subtitle="" colorClass="bg-indigo-500 text-indigo-500" link={result.hotelLink} isExternal={true} /></div><div className="text-center p-8 rounded-3xl bg-gradient-to-br from-slate-900 to-slate-800 text-white shadow-xl relative overflow-hidden group"><div className="absolute top-0 right-0 p-8 opacity-10 transform rotate-12 group-hover:rotate-0 transition-transform duration-500"><Heart size={100} fill="currentColor" /></div><Heart className="mx-auto text-rose-500 mb-4 fill-rose-500 animate-pulse" size={32} /><h4 className="text-xl font-bold mb-2">{t.donate_title}</h4><p className="text-slate-300 mb-6 max-w-sm mx-auto text-sm leading-relaxed">{t.donate_text}</p><button className="bg-white text-slate-900 px-8 py-3 rounded-full text-sm font-bold hover:bg-rose-50 hover:text-rose-600 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">{t.donate_btn}</button></div></div>
                    </div>
                )}
            </>
        )}

      </main>
      
      {/* FOOTER (Uniquement sur Home et caché par le menu mobile) */}
      {currentView === 'home' && step === 0 && (
        <footer className="py-8 text-center text-slate-400 text-xs mb-16 sm:mb-0">
            <p>2025 TravelDoc Inc. • {t.footer_rights}</p>
            <p className="opacity-60 text-[10px]">{t.footer_affiliate}</p>
        </footer>
      )}
    </div>
  );
}
